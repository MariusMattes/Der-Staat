{% load static %}
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Anzeige & Urteile</title>
    <link rel="stylesheet" href="{% static 'css/recht.css' %}">
</head>
<body>

{% include "rechtApp/navigationsleiste.html" %}

<div class="hauptbereichDivCLASS">
    <h2 class="UeberschriftCLASS">Bürger-ID finden</h2>
    <form method="POST" class="formularDivCLASS">
        {% csrf_token %}
        <input type="hidden" name="action" value="suche_buerger">

        <label>Vorname:</label> 
        <input class="eingabeFeldCLASS" type="text" name="vorname" required>
    
        <label>Nachname:</label>
        <input class="eingabeFeldCLASS" type="text" name="nachname" required>

        <label>Geburtsdatum:</label>
        <input class="eingabeFeldCLASS" type="text" name="geburtsdatum" required>
        
        <button type="submit" class="buttonPrimarCLASS">Suchen</button>
    </form>

    {% if buerger_id %}
        <p><b>Gefundene Bürger-ID:</b> {{ buerger_id }}</p>
    {% elif buerger_id is not none %}
        <p>Keine Person gefunden.</p>
    {% endif %}

</div>

{% if beruf == "Polizist" %}
<div class="hauptbereichDivCLASS">
    <h2 class="UeberschriftCLASS">Anzeige erstellen</h2>
    <form method="POST" class="formularDivCLASS">
        {% csrf_token %}
        <input type="hidden" name="action" value="neue_anzeige">

        <label>Bürger-ID:</label>
        <input class="eingabeFeldCLASS" type="text" name="anzeige_buerger_id" required>

        <label>Vorname:</label>
        <input class="eingabeFeldCLASS" type="text" name="vorname" required>

        <!-- A -->
        <label>Gesetz:</label>
        <select class="eingabeFeldCLASS" name="gesetz_id" id="gesetz_select" required>
            <option value="">-- Gesetz auswählen --</option>
            {% for gesetz in gesetze %}
                <option value="{{ gesetz.id }}" data-titel="{{ gesetz.titel }}">
                    {{ gesetz.id }}
                </option>
            {% endfor %}
        </select>
        <label>Gesetz-Titel:</label>
        <input class="eingabeFeldCLASS"type="text"id="gesetz_titel_anzeige"readonly>
        <input type="hidden" name="gesetz_titel" id="gesetz_titel_hidden">

        <!-- /A -->
    
    

        
        <!--<label>Gesetz-Titel:</label>
        <input class="eingabeFeldCLASS" type="text" name="gesetz_titel">
        -->
        <label>Begründung:</label>
        <textarea class="eingabeFeldCLASS" name="begruendung"></textarea>

        <button type="submit" class="buttonPrimarCLASS">Anzeige abschicken</button>
        {% endif %}
    </form>
</div>

<div class="hauptbereichDivCLASS">
    <h2 class="UeberschriftCLASS">Offene Anzeigen</h2>

    {% for anzeige in anzeigen %}
        <div class="karteDivCLASS">
            <p><b>Bürger-ID:</b> {{ anzeige.buerger_id }}</p>
            <p><b>Vorname:</b> {{ anzeige.vorname }}</p>
            <p><b>Gesetz-ID:</b> {{ anzeige.gesetz_id }}</p>
            <p><b>Begründung:</b> {{ anzeige.begruendung }}</p>

            {% if beruf == "Richter" %}
                <form method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="zustimmen">
                    <input type="hidden" name="anzeige_index" value="{{ forloop.counter0 }}">
                    <button class="buttonPrimarCLASS">Zustimmen</button>
                </form>

                <form method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="ablehnen">
                    <input type="hidden" name="anzeige_index" value="{{ forloop.counter0 }}">
                    <button class="buttonSekundaerCLASS">Ablehnen</button>
                </form>
            {% endif %}
        </div>
    {% empty %}
        <p>Keine offenen Anzeigen.</p>
    {% endfor %}
</div>

{% include "rechtApp/banner.html" %}
<!-- A -->
<script>
const gesetzSelectElement = document.getElementById("gesetz_select");
gesetzSelectElement.addEventListener("change", function () {
    const ausgewaehlterIndex = gesetzSelectElement.selectedIndex;
    const ausgewaehlteOption = gesetzSelectElement.options[ausgewaehlterIndex];
    const gesetzTitel = ausgewaehlteOption.getAttribute("data-titel");

    document.getElementById("gesetz_titel_anzeige").value = gesetzTitel;
    document.getElementById("gesetz_titel_hidden").value = gesetzTitel;
});
</script>

</script>
<!-- /A -->
</body>
</html>
